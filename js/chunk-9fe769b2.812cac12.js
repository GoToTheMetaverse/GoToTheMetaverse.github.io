(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9fe769b2"],{"159b":function(e,t,i){var r=i("da84"),s=i("fdbc"),a=i("17c2"),n=i("9112");for(var l in s){var c=r[l],o=c&&c.prototype;if(o&&o.forEach!==a)try{n(o,"forEach",a)}catch(d){o.forEach=a}}},"17c2":function(e,t,i){"use strict";var r=i("b727").forEach,s=i("a640"),a=s("forEach");e.exports=a?[].forEach:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}},"4e87":function(e,t,i){"use strict";i.r(t);var r=i("7a23"),s={class:"tw-rounded bg-white mb-2"},a={class:"flex justify-center"},n={class:"w-full py-2 md:px-5"},l={class:"flex justify-between items-center px-3 md:p-0"},c=Object(r["h"])("img",{src:"/images/hero-back.svg",alt:"back"},null,-1),o={class:"mx-2 text-2xl"},d={class:"flex space-x-2"},u={key:0,class:"text-red-600 pb-2"},b={class:"pb-0 md:pb-5 px-0 md:px-5"},f={class:"flex justify-center item-start"},h={key:1,class:"\n        absolute\n        inset-0\n        bg-black bg-opacity-50\n        flex\n        justify-center\n        items-start\n        h-full\n        p-5\n      "},m={class:"relative w-full rounded-lg bg-white p-2"},g={class:"flex justify-between items-center"},w=Object(r["h"])("div",null,"내 타일을 붙일 수 있습니다.",-1),p=Object(r["h"])("img",{src:"/images/hero-x-outline.svg"},null,-1),v={class:"p-2 h-96 rounded-lg overflow-y-auto bg-gray-300"},k={class:"grid grid-cols-3 gap-2"};function j(e,t,i,j,O,x){return Object(r["q"])(),Object(r["d"])("div",s,[Object(r["h"])("div",a,[Object(r["h"])("div",n,[Object(r["h"])("div",l,[Object(r["h"])("button",{class:"w-8 h-8 mr-2",onClick:t[1]||(t[1]=function(t){return e.$router.back()})},[c]),Object(r["h"])("div",o,Object(r["z"])(O.wallName),1),Object(r["h"])("div",d,[Object(r["h"])("button",{class:x.addTileClass,onClick:t[2]||(t[2]=function(e){return x.onShowMyTile(!0)})}," 내 타일 ",2)])])])]),O.errorMessage.length>0?(Object(r["q"])(),Object(r["d"])("div",u,Object(r["z"])(O.errorMessage),1)):Object(r["e"])("",!0),Object(r["h"])("div",b,[Object(r["h"])("div",f,[Object(r["h"])("iframe",{class:"tw-rounded overflow-hidden",ref:"visitWallFrame",src:"/kbEditWall/main.html",width:O.frameWidth,height:O.frameHeight,scrolling:"no",frameborder:"0"},"\n        ",8,["width","height"])])]),O.showMyTileList?(Object(r["q"])(),Object(r["d"])("div",h,[Object(r["h"])("div",m,[Object(r["h"])("div",g,[w,Object(r["h"])("button",{class:"p-1 w-8 h-8",onClick:t[3]||(t[3]=function(e){return O.showMyTileList=!1})},[p])]),Object(r["h"])("div",v,[Object(r["h"])("div",k,[(Object(r["q"])(!0),Object(r["d"])(r["a"],null,Object(r["w"])(x.listPic,(function(t){return Object(r["q"])(),Object(r["d"])("button",{class:"shadow rounded-lg overflow-hidden bg-white",key:t.rid,onClick:function(e){return x.onSelectTile(t)}},[Object(r["h"])("img",{class:"w-full",src:e.$store.makePicUrl(t.pic_url)},null,8,["src"]),Object(r["h"])("div",null,Object(r["z"])(t.pic_name),1)],8,["onClick"])})),128))])])])])):Object(r["e"])("",!0)])}var O=i("1da1"),x=(i("159b"),i("96cf"),{data:function(){return{iframeWin:null,wallRid:0,wallName:"",wallUserName:"",loading:!1,loadingSuccess:!1,errorMessage:"",frameWidth:"100%",frameHeight:"100%",showMyTileList:!1,enableAddTile:!1}},mounted:function(){var e=this;return Object(O["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.iframeWin=e.$refs.visitWallFrame.contentWindow,console.log("mounted this.iframeWin",e.iframeWin),e.wallRid=parseInt(e.$route.params.rid,10),console.log("WallVisit",e.wallRid),window.addEventListener("message",e.procMessage);case 5:case"end":return t.stop()}}),t)})))()},unmounted:function(){window.removeEventListener("message",this.procMessage)},computed:{addTileClass:function(){return this.enableAddTile?"tw-indigo-btn":"tw-gray-btn"},listPic:function(){if(Array.isArray(this.$store.state.listPicture)){var e=[];return this.$store.state.listPicture.forEach((function(t){""!=t.pic_url&&e.push(t)})),e}return[]}},methods:{procMessage:function(e){var t=this;return Object(O["a"])(regeneratorRuntime.mark((function i(){var r,s,a,n,l,c;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(void 0!==e.data.cmd){i.next=2;break}return i.abrupt("return");case 2:if(!(e.data.cmd.indexOf("kbEditWall")<0)){i.next=4;break}return i.abrupt("return");case 4:if(r=e.data,console.log("WallVisit procMessage",r),"kbEditWall.loadingComplete"!=r.cmd){i.next=21;break}return i.next=9,t.$store.wait(1e3);case 9:return s={api:"getWall",loginToken:localStorage.getItem("loginToken"),userUid:t.$store.getters.userUid,wallRid:t.wallRid,needPic:null===t.$store.state.listPicture,isVisit:!0},i.next=12,t.$store.callAsync(s);case 12:if(a=i.sent,100==a.code){i.next=16;break}return t.errorMessage=a.message,i.abrupt("return");case 16:console.log("getWall res",a),t.wallName=a.wall.wall_name,t.$store.postMessage(t.iframeWin,{cmd:"kbEditWall.firstData",user_uid:t.$store.getters.userUid,wall_data:a.wall.wall_data,visit_list:a.visit_list,mode:"visit"}),i.next=49;break;case 21:if("kbEditWall.frameSize"!=r.cmd){i.next=27;break}console.log("frameSize",r.w,r.h),t.frameWidth=r.w,t.frameHeight=r.h,i.next=49;break;case 27:if("kbEditWall.setEnableAddTile"!=r.cmd){i.next=31;break}t.enableAddTile=r.enable,i.next=49;break;case 31:if("kbEditWall.saveAtVisit"!=r.cmd){i.next=48;break}return n=r.tile,l={api:"saveWallVisit",loginToken:localStorage.getItem("loginToken"),userUid:t.$store.getters.userUid,wallRid:t.wallRid,tile:n},i.next=36,t.$store.callAsync(l);case 36:return c=i.sent,i.next=39,t.$store.wait(1e3);case 39:if(100==c.code){i.next=44;break}return console.log("saveWallVisit err",c),t.errorMessage=c.message,t.$store.postMessage(t.iframeWin,{cmd:"kbEditWall.saveComplete",success:!1}),i.abrupt("return");case 44:console.log("saveWallVisit res",c),t.$store.postMessage(t.iframeWin,{cmd:"kbEditWall.saveComplete",success:!0}),i.next=49;break;case 48:console.error("WallVisit unknown cmd",r.cmd);case 49:case"end":return i.stop()}}),i)})))()},onShowMyTile:function(e){e&&!this.enableAddTile||(this.showMyTileList=e)},onSelectTile:function(e){console.log("onSelectTile",e),this.showMyTileList=!1,this.$store.postMessage(this.iframeWin,{cmd:"kbEditWall.addImageAtVisit",tile:{id:"".concat(e.rid),url:e.pic_url}})}}});x.render=j;t["default"]=x},a640:function(e,t,i){"use strict";var r=i("d039");e.exports=function(e,t){var i=[][e];return!!i&&r((function(){i.call(null,t||function(){throw 1},1)}))}},b727:function(e,t,i){var r=i("0366"),s=i("44ad"),a=i("7b0b"),n=i("50c4"),l=i("65f0"),c=[].push,o=function(e){var t=1==e,i=2==e,o=3==e,d=4==e,u=6==e,b=7==e,f=5==e||u;return function(h,m,g,w){for(var p,v,k=a(h),j=s(k),O=r(m,g,3),x=n(j.length),W=0,y=w||l,E=t?y(h,x):i||b?y(h,0):void 0;x>W;W++)if((f||W in j)&&(p=j[W],v=O(p,W,k),e))if(t)E[W]=v;else if(v)switch(e){case 3:return!0;case 5:return p;case 6:return W;case 2:c.call(E,p)}else switch(e){case 4:return!1;case 7:c.call(E,p)}return u?-1:o||d?d:E}};e.exports={forEach:o(0),map:o(1),filter:o(2),some:o(3),every:o(4),find:o(5),findIndex:o(6),filterOut:o(7)}}}]);
//# sourceMappingURL=chunk-9fe769b2.812cac12.js.map