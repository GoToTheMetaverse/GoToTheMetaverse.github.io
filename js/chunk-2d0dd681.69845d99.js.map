{"version":3,"sources":["webpack:///./src/views/WallEdit.vue","webpack:///./src/views/WallEdit.vue?e31c"],"names":["class","src","alt","$router","back","isEditingName","name","length","onEditName","inputName","onEditNameConfirm","onEditNameCancel","errorMessage","ref","width","frameWidth","height","frameHeight","scrolling","frameborder","type","isShowMine","inputSearch","loadingSearch","onSearch","listPic","data","key","rid","onSearchSelect","$store","makePicUrl","pic_url","pic_name","isSearchMore","onSearchMore","iframeWin","wallRid","loading","loadingSuccess","loadingEditName","errorMessageSearch","searchDatas","mounted","console","log","$refs","myiframe","contentWindow","parseInt","$route","params","window","addEventListener","procMessage","computed","this","Array","isArray","state","listPicture","methods","event","undefined","cmd","indexOf","recv","wait","reqData","api","loginToken","localStorage","getItem","userUid","getters","needPic","callAsync","res","code","message","wall","wall_name","commit","postMessage","wall_data","w","h","reqWeb","arrid","arrimg","error","newWallName","errorEditName","onEditPicNameCancel","id","url","render"],"mappings":"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","file":"js/chunk-2d0dd681.69845d99.js","sourcesContent":["<template>\n  <div class=\"tw-rounded bg-white mb-2\">\n    <div class=\"flex justify-center\">\n      <div class=\"w-full py-2 md:px-5\">\n        <div class=\"flex justify-between items-center px-3 md:p-0\">\n          <button class=\"w-6 h-6 mr-2\" @click=\"$router.back()\">\n            <img src=\"/images/hero-back.svg\" alt=\"back\" />\n          </button>\n          <div v-if=\"!isEditingName\" class=\"mx-2 text-2xl\">{{ name }}</div>\n          <button\n            v-if=\"!isEditingName && name.length > 0\"\n            class=\"px-2 mx-2\"\n            @click=\"onEditName()\"\n          >\n            <img class=\"w-6 h-6\" src=\"/images/hero-edit.svg\" />\n          </button>\n          <input\n            class=\"rounded-lg border-2 border-black px-2\"\n            v-if=\"isEditingName\"\n            v-model=\"inputName\"\n          />\n          <div v-if=\"isEditingName\">\n            <button @click=\"onEditNameConfirm()\" class=\"ml-2\">\n              <img class=\"w-8 h-8\" src=\"/images/hero-confirm-outline.svg\" />\n            </button>\n            <button @click=\"onEditNameCancel()\" class=\"ml-2\">\n              <img class=\"w-8 h-8\" src=\"/images/hero-x-outline.svg\" />\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div v-if=\"errorMessage.length > 0\" class=\"text-red-600 pb-2\">\n      {{ errorMessage }}\n    </div>\n\n    <div class=\"pb-0 md:pb-5 px-0 md:px-5\">\n      <div class=\"flex justify-center item-start\">\n        <iframe\n          class=\"tw-rounded overflow-hidden\"\n          ref=\"myiframe\"\n          src=\"/kbEditWall/main.html\"\n          :width=\"frameWidth\"\n          :height=\"frameHeight\"\n          scrolling=\"no\"\n          frameborder=\"0\"\n        >\n        </iframe>\n      </div>\n    </div>\n  </div>\n  <!-- search -->\n  <div class=\"tw-rounded bg-white p-2\">\n    <div class=\"mb-2 flex justify-center items-center\">\n      <input class=\"w-4 h-4 mr-2\" type=\"checkbox\" v-model=\"isShowMine\" />\n      <div>내꺼만 표시</div>\n    </div>\n    <div v-if=\"!isShowMine\" class=\"mb-2 flex justify-center\">\n      <input\n        class=\"mr-2 px-2 rounded-lg border-2 border-black\"\n        v-model=\"inputSearch\"\n      />\n      <button\n        v-if=\"!loadingSearch\"\n        class=\"px-4 py-1 rounded-lg bg-indigo-600 text-white\"\n        @click=\"onSearch()\"\n      >\n        검색\n      </button>\n    </div>\n    <div class=\"grid grid-cols-3 gap-1 px-2\">\n      <div\n        class=\"w-24\"\n        v-for=\"data in listPic\"\n        :key=\"data.rid\"\n        @click=\"onSearchSelect(data)\"\n      >\n        <img class=\"h-24\" :src=\"$store.makePicUrl(data.pic_url)\" />\n        <div class=\"font-bold\">{{ data.pic_name }}</div>\n      </div>\n    </div>\n\n    <button\n      v-if=\"isSearchMore\"\n      class=\"px-4 py-1 rounded-lg bg-indigo-600 text-white\"\n      @click=\"onSearchMore()\"\n    >\n      더보기\n    </button>\n  </div>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      iframeWin: null,\n\n      wallRid: 0,\n      name: \"\",\n      loading: false,\n      loadingSuccess: false,\n      errorMessage: \"\",\n      frameWidth: \"100%\",\n      frameHeight: \"100%\",\n\n      isEditingName: false,\n      inputName: \"\",\n      loadingEditName: false,\n\n      isShowMine: true,\n      inputSearch: \"\",\n      loadingSearch: false,\n      errorMessageSearch: \"\",\n      isSearchMore: false,\n      searchDatas: [],\n    };\n  },\n  async mounted() {\n    console.log(\"WallEdit mounted\");\n    this.iframeWin = this.$refs.myiframe.contentWindow;\n    this.wallRid = parseInt(this.$route.params.rid, 10);\n    this.searchDatas = [\n      // { rid: 30, pic_name: \"30\", pic_url: \"http://localhost/update/30.png\" },\n      // { rid: 31, pic_name: \"31\", pic_url: \"http://localhost/update/31.png\" },\n      // { rid: 32, pic_name: \"32\", pic_url: \"http://localhost/update/32.png\" },\n    ];\n\n    window.addEventListener(\"message\", this.procMessage);\n  },\n  computed: {\n    listPic() {\n      if (this.isShowMine) {\n        // console.log(\"listPic isShowMine\", typeof this.$store.state.listPicture);\n        if (Array.isArray(this.$store.state.listPicture)) {\n          // console.log(\"listPic listPicture\", this.$store.state.listPicture);\n          return this.$store.state.listPicture;\n        }\n        return [];\n      } else {\n        return this.searchDatas;\n      }\n    },\n  },\n  methods: {\n    async procMessage(event) {\n      if (event.data.cmd === undefined) return;\n      if (event.data.cmd.indexOf(\"kbEditWall\") < 0) return;\n\n      const recv = event.data;\n      console.log(\"WallEdit.vue procMessage\", recv);\n\n      if (recv.cmd == \"kbEditWall.loadingComplete\") {\n        await this.$store.wait(1000);\n\n        const reqData = {\n          api: \"getWall\",\n          loginToken: localStorage.getItem(\"loginToken\"),\n          userUid: this.$store.getters.userUid,\n          wallRid: this.wallRid,\n          needPic: this.$store.state.listPicture === null,\n        };\n        // console.log(\"getWall req\", reqData);\n\n        const res = await this.$store.callAsync(reqData);\n        if (res.code != 100) {\n          this.errorMessage = res.message;\n          return;\n        }\n\n        console.log(\"getWall res\", res);\n        this.name = res.wall.wall_name;\n        if (res.listPicture !== undefined) {\n          this.$store.commit(\"setListPicture\", res.listPicture);\n        }\n\n        this.$store.postMessage(this.iframeWin, {\n          cmd: \"kbEditWall.firstData\",\n          wall_data: res.wall.wall_data,\n        });\n      } else if (recv.cmd == \"kbEditWall.frameSize\") {\n        console.log(\"frameSize\", recv.w, recv.h);\n        this.frameWidth = recv.w;\n        this.frameHeight = recv.h;\n      } else if (recv.cmd == \"kbEditWall.save\") {\n        console.log(\"kbEditWall.save\", recv);\n\n        await this.$store.wait(1000);\n\n        const reqWeb = {\n          api: \"saveWall\",\n          loginToken: localStorage.getItem(\"loginToken\"),\n          userUid: this.$store.getters.userUid,\n          wallRid: this.wallRid,\n          width: recv.width,\n          height: recv.height,\n          arrid: recv.arrid,\n          arrimg: recv.arrimg,\n        };\n\n        const res = await this.$store.callAsync(reqWeb);\n        if (res.code != 100) {\n          this.errorMessage = res.message;\n          return;\n        }\n\n        // this.$store.commit(\"saveWall\", res.wall);\n        this.$store.postMessage(this.iframeWin, {\n          cmd: \"kbEditWall.saveComplete\",\n        });\n      } else {\n        console.error(\"WallEdit unknown cmd\", recv.cmd);\n      }\n    },\n    async onEditName() {\n      this.isEditingName = true;\n      this.inputName = this.name;\n    },\n    async onEditNameConfirm() {\n      const reqData = {\n        api: \"updateWallName\",\n        loginToken: localStorage.getItem(\"loginToken\"),\n        userUid: this.$store.getters.userUid,\n        wallRid: this.wallRid,\n        newWallName: this.inputName,\n      };\n      console.log(\"onEditNameConfirm\", reqData);\n\n      this.errorMessage = \"\";\n      this.loadingEditName = true;\n      const res = await this.$store.callAsync(reqData);\n      this.loadingEditName = false;\n\n      if (res.code != 100) {\n        this.errorEditName = res.message;\n        return;\n      }\n\n      console.log(\"onEditNameConfirm res\", res);\n\n      this.$store.commit(\"updateWall\", {\n        rid: this.wallRid,\n        wall_name: res.newWallName,\n      });\n      this.name = res.newWallName;\n      this.isEditingName = false;\n    },\n    onEditPicNameCancel() {\n      this.isEditingName = false;\n    },\n    async onSearch() {\n      const reqData = {\n        api: \"searchImage\",\n        loginToken: localStorage.getItem(\"loginToken\"),\n        userUid: this.$store.getters.userUid,\n        inputSearch: this.inputSearch,\n      };\n      console.log(\"onSearch req\", reqData);\n\n      this.errorMessageSearch = \"\";\n      this.isSearchMore = false;\n      this.loadingSearch = true;\n      const res = await this.$store.callAsync(reqData);\n      this.loadingSearch = false;\n\n      if (res.code != 100) {\n        this.errorMessageSearch = res.message;\n        return;\n      }\n\n      console.log(\"onSearch res\", res);\n\n      this.searchDatas = res.searchDatas;\n      this.isSearchMore = res.isSearchMore;\n    },\n    onSearchMore() {},\n    onSearchSelect(data) {\n      console.log(\"onClickSearch\", data);\n      this.$store.postMessage(this.iframeWin, {\n        cmd: \"kbEditWall.addImage\",\n        id: data.rid,\n        url: data.pic_url,\n      });\n    },\n  },\n};\n</script>\n","import { render } from \"./WallEdit.vue?vue&type=template&id=e511e940\"\nimport script from \"./WallEdit.vue?vue&type=script&lang=js\"\nexport * from \"./WallEdit.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}