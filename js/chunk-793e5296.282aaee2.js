(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-793e5296"],{"96d3":function(e,t,i){"use strict";i.r(t);var r=i("7a23"),n={class:"flex justify-center rounded-lg bg-white p-2"},c={class:"justify-center w-96"},a={class:"flex justify-between my-2"},s=Object(r["h"])("img",{src:"/images/hero-back.svg",alt:"back"},null,-1),o={key:0,class:"mx-2 text-2xl"},u=Object(r["h"])("img",{class:"w-6 h-6",src:"/images/hero-edit.svg"},null,-1),d={key:3},m=Object(r["h"])("img",{class:"w-8 h-8",src:"/images/hero-confirm-outline.svg"},null,-1),l=Object(r["h"])("img",{class:"w-8 h-8",src:"/images/hero-x-outline.svg"},null,-1),g={class:"flex justify-center"},b={class:"text-red-600"},p={class:"w-96 h-96"};function f(e,t,i,f,h,j){return Object(r["q"])(),Object(r["d"])("div",n,[Object(r["h"])("div",c,[Object(r["h"])("div",a,[Object(r["h"])("button",{class:"w-8 h-8 mr-2",onClick:t[1]||(t[1]=function(t){return e.$router.back()})},[s]),h.isEditingPicName?Object(r["e"])("",!0):(Object(r["q"])(),Object(r["d"])("div",o,Object(r["x"])(h.picName),1)),!h.isEditingPicName&&h.picName.length>0?(Object(r["q"])(),Object(r["d"])("button",{key:1,class:"px-2 mx-2",onClick:t[2]||(t[2]=function(e){return j.onEditName()})},[u])):Object(r["e"])("",!0),h.isEditingPicName?Object(r["C"])((Object(r["q"])(),Object(r["d"])("input",{key:2,class:"rounded-lg border-2 border-black px-2","onUpdate:modelValue":t[3]||(t[3]=function(e){return h.inputPicName=e})},null,512)),[[r["z"],h.inputPicName]]):Object(r["e"])("",!0),h.isEditingPicName?(Object(r["q"])(),Object(r["d"])("div",d,[Object(r["h"])("button",{onClick:t[4]||(t[4]=function(e){return j.onEditPicNameConfirm()}),class:"ml-2"},[m]),Object(r["h"])("button",{onClick:t[5]||(t[5]=function(e){return j.onEditPicNameCancel()}),class:"ml-2"},[l])])):Object(r["e"])("",!0)]),Object(r["h"])("div",g,[Object(r["h"])("div",b,Object(r["x"])(h.errorMessage),1),Object(r["h"])("div",p,[Object(r["h"])("iframe",{class:"rounded-xl overflow-hidden",ref:"myiframe",src:"/kbEditPic/main.html",width:h.frameWidth,height:h.frameHeight,scrolling:"no",frameborder:"0"},"\n          ",8,["width","height"])])])])])}var h=i("1da1"),j=(i("96cf"),i("d3b7"),i("25f0"),i("a15b"),{data:function(){return{picUid:0,picName:"",loadingPic:!1,loadingSuccess:!1,errorMessage:"",frameWidth:"100%",frameHeight:"100%",isEditingPicName:!1,inputPicName:"",loadingEditPicName:!1}},mounted:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var i,r,n,c,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:i=function(e){for(var t=[],i=0;i<e.length;i++){var r=e[i].toString(16);t.push(0==r?" ":r)}return t.join("")},r=e.$store,n=e.$refs.myiframe.contentWindow,c=localStorage.getItem("loginToken"),a=r.getters.userUid,s=parseInt(e.$route.params.picUid,10),console.log("PicEdit",[s,r.getters.userUid]),window.addEventListener("message",function(){var t=Object(h["a"])(regeneratorRuntime.mark((function t(o){var u,d,m,l,g,b,p,f,h;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(void 0!==o.data.cmd){t.next=2;break}return t.abrupt("return");case 2:if(u=o.data,"kbEditPic.loadingComplete"!=u.cmd){t.next=21;break}return t.next=6,r.wait(1e3);case 6:return d={api:"getPicture",loginToken:c,userUid:a,picUid:s},t.next=9,r.callAsync(d);case 9:if(m=t.sent,100==m.code){t.next=13;break}return e.errorMessage=m.message,t.abrupt("return");case 13:for(e.picUid=s,e.picName=m.picture.pic_name,l=[],g=0;g<256;g++)l.push(0);for(b=0;b<m.picture.pic_data.length;b++)p=m.picture.pic_data[b],l[b]=" "==p?0:parseInt(p,16);n.postMessage({cmd:"kbEditPic.firstData",tiles:l},"*"),t.next=39;break;case 21:if("kbEditPic.frameSize"!=u.cmd){t.next=26;break}e.frameWidth=u.w,e.frameHeight=u.h,t.next=39;break;case 26:if("kbEditPic.save"!=u.cmd){t.next=38;break}return f={api:"savePicture",loginToken:c,userUid:a,picUid:s,colors:u.colors,picTileText:i(u.tiles)},t.next=30,r.callAsync(f);case 30:if(h=t.sent,100==h.code){t.next=34;break}return e.errorMessage=h.message,t.abrupt("return");case 34:e.$store.commit("updatePicture",h.picture),n.postMessage({cmd:"kbEditPic.saveComplete"},"*"),t.next=39;break;case 38:console.error("EditPci unknown cmd",u.cmd);case 39:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 8:case"end":return t.stop()}}),t)})))()},methods:{onEditName:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.isEditingPicName=!0,e.inputPicName=e.picName;case 2:case"end":return t.stop()}}),t)})))()},onEditPicNameConfirm:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i={api:"updatePictureName",loginToken:localStorage.getItem("loginToken"),userUid:e.$store.getters.userUid,picUid:e.picUid,newPicName:e.inputPicName},console.log("onEditPicNameConfirm",i),e.errorMessage="",e.loadingEditName=!0,t.next=6,e.$store.callAsync(i);case 6:if(r=t.sent,e.loadingEditName=!1,100==r.code){t.next=11;break}return e.errorEditName=r.message,t.abrupt("return");case 11:console.log("onEditPicNameConfirm res",r),e.$store.commit("updatePicture",{rid:e.picUid,pic_name:r.newPicName}),e.picName=r.newPicName,e.isEditingPicName=!1;case 15:case"end":return t.stop()}}),t)})))()},onEditPicNameCancel:function(){this.isEditingPicName=!1}}});j.render=f;t["default"]=j},a15b:function(e,t,i){"use strict";var r=i("23e7"),n=i("44ad"),c=i("fc6a"),a=i("a640"),s=[].join,o=n!=Object,u=a("join",",");r({target:"Array",proto:!0,forced:o||!u},{join:function(e){return s.call(c(this),void 0===e?",":e)}})},a640:function(e,t,i){"use strict";var r=i("d039");e.exports=function(e,t){var i=[][e];return!!i&&r((function(){i.call(null,t||function(){throw 1},1)}))}}}]);
//# sourceMappingURL=chunk-793e5296.282aaee2.js.map