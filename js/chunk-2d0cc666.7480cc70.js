(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0cc666"],{"4e87":function(e,t,i){"use strict";i.r(t);var s=i("7a23"),a={class:"tw-rounded bg-white mb-2"},r={class:"flex justify-center"},l={class:"w-full py-2 md:px-5"},n={class:"flex justify-between items-center px-3 md:p-0"},c=Object(s["h"])("img",{src:"/images/hero-back.svg",alt:"back"},null,-1),o={class:"mx-2 text-2xl"},d={class:"flex space-x-2"},u={key:0,class:"text-red-600 pb-2"},b={class:"pb-0 md:pb-5 px-0 md:px-5"},m={class:"flex justify-center item-start"},g={key:1,class:"\n        absolute\n        inset-0\n        bg-black bg-opacity-50\n        flex\n        justify-center\n        items-start\n        h-full\n        p-5\n      "},h={class:"relative w-full rounded-lg bg-white p-2"},f={class:"flex justify-between items-center"},w=Object(s["h"])("div",null,"내 타일을 붙일 수 있습니다.",-1),p=Object(s["h"])("img",{src:"/images/hero-x-outline.svg"},null,-1),k={class:"p-2 h-96 rounded-lg overflow-y-auto bg-gray-300"},v={class:"grid grid-cols-3 gap-2"};function j(e,t,i,j,O,x){return Object(s["q"])(),Object(s["d"])("div",a,[Object(s["h"])("div",r,[Object(s["h"])("div",l,[Object(s["h"])("div",n,[Object(s["h"])("button",{class:"w-8 h-8 mr-2",onClick:t[1]||(t[1]=function(t){return e.$router.back()})},[c]),Object(s["h"])("div",o,Object(s["z"])(O.wallName),1),Object(s["h"])("div",d,[Object(s["h"])("button",{class:x.addTileClass,onClick:t[2]||(t[2]=function(e){return x.onShowMyTile(!0)})}," 내 타일 ",2)])])])]),O.errorMessage.length>0?(Object(s["q"])(),Object(s["d"])("div",u,Object(s["z"])(O.errorMessage),1)):Object(s["e"])("",!0),Object(s["h"])("div",b,[Object(s["h"])("div",m,[Object(s["h"])("iframe",{class:"tw-iframe",ref:"visitWallFrame",src:"/kbEditWall/main.html",width:O.frameWidth,height:O.frameHeight,scrolling:"no",frameborder:"0"},"\n        ",8,["width","height"])])]),O.showMyTileList?(Object(s["q"])(),Object(s["d"])("div",g,[Object(s["h"])("div",h,[Object(s["h"])("div",f,[w,Object(s["h"])("button",{class:"p-1 w-8 h-8",onClick:t[3]||(t[3]=function(e){return O.showMyTileList=!1})},[p])]),Object(s["h"])("div",k,[Object(s["h"])("div",v,[(Object(s["q"])(!0),Object(s["d"])(s["a"],null,Object(s["w"])(x.listPic,(function(t){return Object(s["q"])(),Object(s["d"])("button",{class:"shadow rounded-lg overflow-hidden bg-white",key:t.rid,onClick:function(e){return x.onSelectTile(t)}},[Object(s["h"])("img",{class:"w-full",src:e.$store.makePicUrl(t.pic_url)},null,8,["src"]),Object(s["h"])("div",null,Object(s["z"])(t.pic_name),1)],8,["onClick"])})),128))])])])])):Object(s["e"])("",!0)])}var O=i("1da1"),x=(i("159b"),i("96cf"),{data:function(){return{iframeWin:null,wallRid:0,wallName:"",wallUserName:"",loading:!1,loadingSuccess:!1,errorMessage:"",frameWidth:"100%",frameHeight:"100%",showMyTileList:!1,enableAddTile:!1}},mounted:function(){var e=this;return Object(O["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.iframeWin=e.$refs.visitWallFrame.contentWindow,console.log("mounted this.iframeWin",e.iframeWin),e.wallRid=parseInt(e.$route.params.rid,10),console.log("WallVisit",e.wallRid),window.addEventListener("message",e.procMessage);case 5:case"end":return t.stop()}}),t)})))()},unmounted:function(){window.removeEventListener("message",this.procMessage)},computed:{addTileClass:function(){return this.enableAddTile?"tw-indigo-btn":"tw-gray-btn"},listPic:function(){if(Array.isArray(this.$store.state.listPicture)){var e=[];return this.$store.state.listPicture.forEach((function(t){""!=t.pic_url&&e.push(t)})),e}return[]}},methods:{procMessage:function(e){var t=this;return Object(O["a"])(regeneratorRuntime.mark((function i(){var s,a,r,l,n,c;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(void 0!==e.data.cmd){i.next=2;break}return i.abrupt("return");case 2:if(!(e.data.cmd.indexOf("kbEditWall")<0)){i.next=4;break}return i.abrupt("return");case 4:if(s=e.data,console.log("WallVisit procMessage",s),"kbEditWall.loadingComplete"!=s.cmd){i.next=21;break}return i.next=9,t.$store.wait(1e3);case 9:return a={api:"getWall",loginToken:localStorage.getItem("loginToken"),userUid:t.$store.getters.userUid,wallRid:t.wallRid,needPic:null===t.$store.state.listPicture,isVisit:!0},i.next=12,t.$store.callAsync(a);case 12:if(r=i.sent,100==r.code){i.next=16;break}return t.errorMessage=r.message,i.abrupt("return");case 16:console.log("getWall res",r),t.wallName=r.wall.wall_name,t.$store.postMessage(t.iframeWin,{cmd:"kbEditWall.firstData",user_uid:t.$store.getters.userUid,mode:"visit",wall_data:r.wall.wall_data,visit_list:r.visit_list}),i.next=49;break;case 21:if("kbEditWall.frameSize"!=s.cmd){i.next=27;break}console.log("frameSize",s.w,s.h),t.frameWidth=s.w,t.frameHeight=s.h,i.next=49;break;case 27:if("kbEditWall.setEnableAddTile"!=s.cmd){i.next=31;break}t.enableAddTile=s.enable,i.next=49;break;case 31:if("kbEditWall.saveAtVisit"!=s.cmd){i.next=48;break}return l=s.tile,n={api:"saveWallVisit",loginToken:localStorage.getItem("loginToken"),userUid:t.$store.getters.userUid,wallRid:t.wallRid,tile:l},i.next=36,t.$store.callAsync(n);case 36:return c=i.sent,i.next=39,t.$store.wait(1e3);case 39:if(100==c.code){i.next=44;break}return console.log("saveWallVisit err",c),t.errorMessage=c.message,t.$store.postMessage(t.iframeWin,{cmd:"kbEditWall.saveComplete",success:!1}),i.abrupt("return");case 44:console.log("saveWallVisit res",c),t.$store.postMessage(t.iframeWin,{cmd:"kbEditWall.saveComplete",success:!0}),i.next=49;break;case 48:console.error("WallVisit unknown cmd",s.cmd);case 49:case"end":return i.stop()}}),i)})))()},onShowMyTile:function(e){e&&!this.enableAddTile||(this.showMyTileList=e)},onSelectTile:function(e){console.log("onSelectTile",e),this.showMyTileList=!1,this.$store.postMessage(this.iframeWin,{cmd:"kbEditWall.addImageAtVisit",tile:{id:"".concat(e.rid),url:e.pic_url}})}}});x.render=j;t["default"]=x}}]);
//# sourceMappingURL=chunk-2d0cc666.7480cc70.js.map